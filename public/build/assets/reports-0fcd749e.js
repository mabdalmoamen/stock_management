import{_ as y,L as x,r as k,o as n,c as i,a as e,w,d,v as g,i as f,F as h,g as m,t as c,b as v,j as V,n as r,h as C,k as U,p as I,l as S}from"./app-7e9eed4f.js";const L={name:"reports",methods:{async viewReport(){this.loading=!0,this.error=null,this.reports=[],this.items=[],await axios.get("api/inuses",{params:this.filters}).then(t=>{this.reports=t.data,this.items=t.data[0].items,this.loading=!1}).catch(t=>{this.loading=!1,this.error=t.response.data.message,console.log(t)})},async getCustomers(){await axios.get("api/customers").then(t=>{this.customers=t.data}).catch(t=>{console.log(t)})},async getUsers(){await axios.get("api/users").then(t=>{this.users=t.data}).catch(t=>{console.log(t)})},setItems(t){this.selectedIndex=this.reports.indexOf(t),this.items=t.items},async update(t){await axios.patch(`api/inuses/${t.id}`,t).then(l=>{this.viewReport(),alert("تم تحديث الحالة بنجاح")}).catch(l=>{console.log(l)})}},async mounted(){await this.getCustomers(),await this.getUsers()},data(){return{search:"",filters:{customer_id:null,user_id:null,in_use:null},customers:[],selectedIndex:0,users:[],error:null,reports:[],loading:!1,items:[]}},components:{Loader:x}},a=t=>(I("data-v-f6ffaae4"),t=t(),S(),t),M={class:"card"},B={class:"card-header"},R={class:"row"},N={class:"col-6"},D={class:"form-group mb-2"},F={class:"col-6"},T={class:"form-group mx-2 mb-2"},j=a(()=>e("option",{value:null},"الموظف",-1)),q=["value"],z={class:"col-6"},E={class:"form-group mx-2 mb-2"},K=a(()=>e("option",{value:null},"مدير الجرد الحاسب",-1)),O=["value"],A={class:"col-6"},G={class:"form-group mx-2 mb-2"},H=a(()=>e("option",{value:null},"الحالة",-1)),J=a(()=>e("option",{value:"1"},"مستلمه",-1)),P=a(()=>e("option",{value:"0"},"غير مستلمه",-1)),Q=[H,J,P],W={class:"col-6"},X={class:"form-group mx-2 mb-2"},Y={class:"col-6"},Z={class:"form-group mx-2 mb-2"},$=a(()=>e("button",{type:"submit",class:"btn btn-primary mb-2 float-start"}," بحث ",-1)),ee={class:"card-body"},se={key:0,class:"alert alert-sm alert-danger"},te={key:2,class:"table-responsive text-center"},oe={class:"table table-bordered"},le=a(()=>e("thead",null,[e("tr",null,[e("th",{scope:"col"},"M"),e("th",{scope:"col"},"العميل"),e("th",{scope:"col"},"مدير الجرد الحاسب"),e("th",{scope:"col"},"الحالة"),e("th",{scope:"col"},"تاريخ دخول العهدة"),e("th",{scope:"col"},"تاريخ خروج العهدة")])],-1)),ne=["onClick"],ie={class:"form-check-label",style:{cursor:"pointer"}},ce=["onUpdate:modelValue","checked","onChange"],ae={key:0,class:"table table-bordered"},de=a(()=>e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"العهد"),e("th",{scope:"col"},"الكمية")])],-1)),re={scope:"row"};function ue(t,l,_e,he,o,_){const b=k("Loader");return n(),i("div",null,[e("div",M,[e("div",B,[e("form",{onSubmit:l[7]||(l[7]=w(s=>_.viewReport(),["prevent"]))},[e("div",R,[e("div",N,[e("div",D,[d(e("input",{type:"text",class:"form-control",placeholder:"كود-باركود-اسم الصنف","onUpdate:modelValue":l[0]||(l[0]=s=>o.filters.item_id=s),onKeyup:l[1]||(l[1]=s=>_.viewReport())},null,544),[[g,o.filters.item_id]])])]),e("div",F,[e("div",T,[d(e("select",{class:"form-control","onUpdate:modelValue":l[2]||(l[2]=s=>o.filters.customer_id=s)},[j,(n(!0),i(h,null,m(o.customers,s=>(n(),i("option",{key:s.id,value:s.id},c(s.name),9,q))),128))],512),[[f,o.filters.customer_id]])])]),e("div",z,[e("div",E,[d(e("select",{class:"form-control","onUpdate:modelValue":l[3]||(l[3]=s=>o.filters.user_id=s)},[K,(n(!0),i(h,null,m(o.users,s=>(n(),i("option",{key:s.id,value:s.id},c(s.name),9,O))),128))],512),[[f,o.filters.user_id]])])]),e("div",A,[e("div",G,[d(e("select",{class:"form-control","onUpdate:modelValue":l[4]||(l[4]=s=>o.filters.in_use=s)},Q,512),[[f,o.filters.in_use]])])]),e("div",W,[e("div",X,[d(e("input",{type:"date",class:"form-control","onUpdate:modelValue":l[5]||(l[5]=s=>o.filters.start_date=s)},null,512),[[g,o.filters.start_date]])])]),e("div",Y,[e("div",Z,[d(e("input",{type:"date",class:"form-control","onUpdate:modelValue":l[6]||(l[6]=s=>o.filters.end_date=s)},null,512),[[g,o.filters.end_date]])])])]),$],32)]),e("div",ee,[o.error?(n(),i("div",se,c(o.error),1)):v("",!0),o.loading?(n(),V(b,{key:1,loading:o.loading},null,8,["loading"])):(n(),i("div",te,[e("table",oe,[le,e("tbody",null,[(n(!0),i(h,null,m(o.reports,(s,u)=>(n(),i("tr",{key:u,style:{color:"white",cursor:"pointer"},class:r(["text-center text-light",{selected:u===o.selectedIndex}])},[e("th",{class:r(`${s.in_use?"bg-success":"bg-danger"}`),scope:"row",onClick:p=>_.setItems(s)},c(u+1),11,ne),e("td",{class:r(`${s.in_use?"bg-success":"bg-danger"}`)},c(s.customer.name),3),e("td",{class:r(`${s.in_use?"bg-success":"bg-danger"}`)},c(s.user.name),3),e("td",{class:r([`${s.in_use?"bg-success":"bg-danger"}`,"text-center"])},[e("label",ie,[C(c(s.in_use?"مستلمه":"غير مستلمه")+" ",1),d(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":p=>s.in_use=p,checked:s.in_use,onChange:p=>_.update(s)},null,40,ce),[[U,s.in_use]])])],2),e("td",{class:r(`${s.in_use?"bg-success":"bg-danger"}`)},c(s.created_at),3),e("td",{class:r(`${s.in_use?"bg-success":"bg-danger"}`)},c(s.updated_at),3)],2))),128))])]),o.items.length>0?(n(),i("table",ae,[de,e("tbody",null,[(n(!0),i(h,null,m(o.items,(s,u)=>(n(),i("tr",{key:u,class:"text-center"},[e("th",re,c(u+1),1),e("td",null,c(s.item.name),1),e("td",null,c(s.quantity),1)]))),128))])])):v("",!0)]))])])])}const pe=y(L,[["render",ue],["__scopeId","data-v-f6ffaae4"]]);export{pe as default};
