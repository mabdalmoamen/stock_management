import{_,o as n,c as i,a as e,d,v as h,b as u,F as m,g as p,n as y,t as l}from"./app-29bb10a6.js";const g={data(){return{search:"",employee:null,employees:[],items:[],cart:[],form:{},barcode:null}},async mounted(){await this.getEmployee(),await this.getItems()},computed:{filteredList(){return this.employees.filter(t=>t.name.toLowerCase().includes(this.search.toLowerCase()))}},methods:{async findEmployee(){await axios.get("api/customers/"+this.search).then(t=>{this.employee=t.data}).catch(t=>{this.employee=null,console.log(t)})},async findByBarcode(){this.barcode&&await axios.get("api/items/"+this.barcode).then(t=>{t.data?(this.addToCart(t.data),this.barcode=null):alert("الباركود غير صحيح")}).catch(t=>{console.log(t)})},async updateQty(t){t.qty<1&&(alert("الكمية لا تقل عن صفر"),t.qty=1),t.qty>t.quantity&&(alert("الكمية لا تزيد عن متوفرة"),t.qty=t.quantity),this.cart=[...this.cart]},async getEmployee(){await await axios.get("api/customers").then(t=>{this.employees=t.data}).catch(t=>{console.log(t)})},async getItems(){await axios.get("api/items").then(t=>{this.items=t.data}).catch(t=>{console.log(t)})},async addToCart(t){if(this.cart.indexOf(t)!==-1){alert("هذه المعدة موجودة في السلة");return}t.qty=1,this.cart.push(t),this.cart=[...this.cart]},async removeFromCart(t){this.cart.splice(this.cart.indexOf(t),1),this.cart=[...this.cart]},async submit(){if(this.cart.length===0){alert("يجب اختيار معدة واحده على الاقل");return}if(this.employee===null||this.employee===void 0||this.employee===""){alert("يجب اختيار الموظف");return}this.form.customer_id=this.employee.id,this.form.cart=this.cart,await axios.post("api/inuses",this.form).then(t=>{this.cart=[],this.form={},this.form.cart=[],alert(" تمت العملية بنجاح "),this.$router.push({name:"home"})})}}},v={class:"card text-center p-0 m-0 min-vh-100"},f={class:"card-header"},b={class:"d-flex justify-content-around"},x=e("h5",null,"صرف معدة",-1),w=["value"],C={class:"card-body p-0 m-0"},q={class:"row"},k={class:"col-6"},B={key:0,class:"card min-vh-100"},V=e("div",{class:"card-header"},[e("h5",{class:"card-title text-end"},"المعدات")],-1),E={class:"card-body m-0 p-0"},F={class:"row"},L=["onClick"],T={class:"card-body p-0 m-0"},U=["src"],D={class:"card-text text-end p-0 m-0"},I={class:"col-6"},N={key:0,class:"card min-vh-100"},O=e("div",{class:"card-header"},[e("h5",{class:"card-title text-end"},"السلة")],-1),Q={class:"card-body m-0 p-0"},j={class:"row"},z={class:"card mb-2"},K={class:"card-body p-0 m-0"},M=["src"],S=["onClick"],X={class:"card-text text-end p-0 m-0"},A={class:"card-footer p-0 m-0"},G=["onUpdate:modelValue","onChange"];function H(t,a,J,P,o,c){return n(),i("div",v,[e("div",f,[e("div",b,[x,d(e("input",{type:"text",placeholder:"كود-باركود المعدة",class:"form-control w-25","onUpdate:modelValue":a[0]||(a[0]=s=>o.barcode=s),onChange:a[1]||(a[1]=s=>c.findByBarcode())},null,544),[[h,o.barcode]]),d(e("input",{type:"text",placeholder:"كود-جوال الموظف",class:"form-control w-25","onUpdate:modelValue":a[2]||(a[2]=s=>o.search=s),onKeyup:a[3]||(a[3]=s=>c.findEmployee())},null,544),[[h,o.search]]),o.employee?(n(),i("input",{key:0,class:"form-control w-25",readonly:"",value:o.employee.name},null,8,w)):u("",!0),e("button",{class:"btn btn-primary",onClick:a[4]||(a[4]=s=>c.submit())},"حفظ")])]),e("div",C,[e("div",q,[e("div",k,[o.items.length?(n(),i("div",B,[V,e("div",E,[e("div",F,[(n(!0),i(m,null,p(o.items,s=>(n(),i("div",{class:"col-4",key:s.id},[e("div",{class:"card mb-2",onClick:r=>c.addToCart(s),style:{cursor:"pointer"}},[e("div",T,[e("span",{class:y(["float-start position-absolute",`
                                                        ${s.quantity<1?"badge bg-danger":"badge bg-success"}
                                                    `]),style:{right:"0",top:"0"}},l(s.quantity),3),e("img",{class:"card-img-top",src:s.image,width:"100",height:"100"},null,8,U),e("div",D,l(s.name),1)])],8,L)]))),128))])])])):u("",!0)]),e("div",I,[o.cart.length?(n(),i("div",N,[O,e("div",Q,[e("div",j,[(n(!0),i(m,null,p(o.cart,s=>(n(),i("div",{class:"col-6",key:s.id},[e("div",z,[e("div",K,[e("span",{class:y(["float-start position-absolute",`
                                                        ${s.quantity<1?"badge bg-danger":"badge bg-success"}
                                                    `]),style:{right:"0",top:"0"}},l(s.quantity),3),e("img",{class:"card-img-top",src:s.image,width:"100",height:"100"},null,8,M),e("button",{class:"btn font-weight-bolder btn-danger float-start position-absolute",style:{left:"0",top:"0"},onClick:r=>c.removeFromCart(s)}," X ",8,S),e("div",X,l(s.name),1)]),e("div",A,[d(e("input",{class:"form-control text-center",type:"number",min:"1","onUpdate:modelValue":r=>s.qty=r,onChange:r=>c.updateQty(s)},null,40,G),[[h,s.qty]])])])]))),128))])])])):u("",!0)])])])])}const W=_(g,[["render",H]]);export{W as default};
