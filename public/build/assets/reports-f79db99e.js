import{_ as f,o as i,c as n,a as s,w as y,d as r,v as g,i as v,F as h,g as m,t as c,b,n as d,h as x,j as k,p as w,k as V}from"./app-0df0aeeb.js";const U={name:"reports",methods:{async viewReport(){this.loading=!0,this.error=null,this.reports=[],this.items=[],await axios.get("api/inuses",{params:this.filters}).then(t=>{this.reports=t.data,this.items=t.data[0].items,this.loading=!1}).catch(t=>{this.loading=!1,this.error=t.response.data.message,console.log(t)})},async getCustomers(){await axios.get("api/customers").then(t=>{this.customers=t.data}).catch(t=>{console.log(t)})},async getUsers(){await axios.get("api/users").then(t=>{this.users=t.data}).catch(t=>{console.log(t)})},setItems(t){this.selectedIndex=this.reports.indexOf(t),this.items=t.items},async update(t){await axios.patch(`api/inuses/${t.id}`,t).then(l=>{this.viewReport(),alert("تم تحديث الحالة بنجاح")}).catch(l=>{console.log(l)})}},async mounted(){await this.getCustomers(),await this.getUsers()},data(){return{search:"",filters:{customer_id:null,user_id:null,in_use:null},customers:[],selectedIndex:0,users:[],error:null,reports:[],loading:!1,items:[]}}},a=t=>(w("data-v-e344b15b"),t=t(),V(),t),C={class:"card"},I={class:"card-header"},S={class:"row"},M={class:"col-6"},R={class:"form-group mb-2"},B={class:"col-6"},N={class:"form-group mx-2 mb-2"},D=a(()=>s("option",{value:null},"الموظف",-1)),F=["value"],T={class:"col-6"},j={class:"form-group mx-2 mb-2"},q=a(()=>s("option",{value:null},"المستخدم",-1)),z=["value"],E={class:"col-6"},K={class:"form-group mx-2 mb-2"},L=a(()=>s("option",{value:null},"الحالة",-1)),O=a(()=>s("option",{value:"1"},"مستلمه",-1)),A=a(()=>s("option",{value:"0"},"غير مستلمه",-1)),G=[L,O,A],H={class:"col-6"},J={class:"form-group mx-2 mb-2"},P={class:"col-6"},Q={class:"form-group mx-2 mb-2"},W=a(()=>s("button",{type:"submit",class:"btn btn-primary mb-2 float-start"}," بحث ",-1)),X={class:"card-body"},Y={key:0,class:"alert alert-sm alert-danger"},Z={key:1},$=a(()=>s("div",{class:"text-center"},[s("div",{class:"spinner-border text-primary",style:{width:"3rem",height:"3rem"},role:"status"},[s("span",{class:"sr-only"})])],-1)),ss=[$],es={key:2,class:"table-responsive text-center"},ts={class:"table table-bordered"},os=a(()=>s("thead",null,[s("tr",null,[s("th",{scope:"col"},"#"),s("th",{scope:"col"},"العميل"),s("th",{scope:"col"},"المستخدم"),s("th",{scope:"col"},"الحالة"),s("th",{scope:"col"},"تاريخ الصرف"),s("th",{scope:"col"},"تاريخ التسليم")])],-1)),ls=["onClick"],is={class:"form-check-label",style:{cursor:"pointer"}},ns=["onUpdate:modelValue","checked","onChange"],cs={key:0,class:"table table-bordered"},as=a(()=>s("thead",null,[s("tr",null,[s("th",{scope:"col"},"#"),s("th",{scope:"col"},"المنتج"),s("th",{scope:"col"},"الكمية")])],-1)),rs={scope:"row"};function ds(t,l,us,_s,o,_){return i(),n("div",null,[s("div",C,[s("div",I,[s("form",{onSubmit:l[7]||(l[7]=y(e=>_.viewReport(),["prevent"]))},[s("div",S,[s("div",M,[s("div",R,[r(s("input",{type:"text",class:"form-control",placeholder:"كود-باركود-اسم الصنف","onUpdate:modelValue":l[0]||(l[0]=e=>o.filters.item_id=e),onKeyup:l[1]||(l[1]=e=>_.viewReport())},null,544),[[g,o.filters.item_id]])])]),s("div",B,[s("div",N,[r(s("select",{class:"form-control","onUpdate:modelValue":l[2]||(l[2]=e=>o.filters.customer_id=e)},[D,(i(!0),n(h,null,m(o.customers,e=>(i(),n("option",{key:e.id,value:e.id},c(e.name),9,F))),128))],512),[[v,o.filters.customer_id]])])]),s("div",T,[s("div",j,[r(s("select",{class:"form-control","onUpdate:modelValue":l[3]||(l[3]=e=>o.filters.user_id=e)},[q,(i(!0),n(h,null,m(o.users,e=>(i(),n("option",{key:e.id,value:e.id},c(e.name),9,z))),128))],512),[[v,o.filters.user_id]])])]),s("div",E,[s("div",K,[r(s("select",{class:"form-control","onUpdate:modelValue":l[4]||(l[4]=e=>o.filters.in_use=e)},G,512),[[v,o.filters.in_use]])])]),s("div",H,[s("div",J,[r(s("input",{type:"date",class:"form-control","onUpdate:modelValue":l[5]||(l[5]=e=>o.filters.start_date=e)},null,512),[[g,o.filters.start_date]])])]),s("div",P,[s("div",Q,[r(s("input",{type:"date",class:"form-control","onUpdate:modelValue":l[6]||(l[6]=e=>o.filters.end_date=e)},null,512),[[g,o.filters.end_date]])])])]),W],32)]),s("div",X,[o.error?(i(),n("div",Y,c(o.error),1)):b("",!0),o.loading?(i(),n("div",Z,ss)):(i(),n("div",es,[s("table",ts,[os,s("tbody",null,[(i(!0),n(h,null,m(o.reports,(e,u)=>(i(),n("tr",{key:u,onClick:p=>_.setItems(e),style:{color:"white",cursor:"pointer"},class:d(["text-center text-light",{selected:u===o.selectedIndex}])},[s("th",{class:d(`${e.in_use?"bg-success":"bg-danger"}`),scope:"row"},c(u+1),3),s("td",{class:d(`${e.in_use?"bg-success":"bg-danger"}`)},c(e.customer.name),3),s("td",{class:d(`${e.in_use?"bg-success":"bg-danger"}`)},c(e.user.name),3),s("td",{class:d([`${e.in_use?"bg-success":"bg-danger"}`,"text-center"])},[s("label",is,[x(c(e.in_use?"مستلمه":"غير مستلمه")+" ",1),r(s("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":p=>e.in_use=p,checked:e.in_use,onChange:p=>_.update(e)},null,40,ns),[[k,e.in_use]])])],2),s("td",{class:d(`${e.in_use?"bg-success":"bg-danger"}`)},c(e.created_at),3),s("td",{class:d(`${e.in_use?"bg-success":"bg-danger"}`)},c(e.updated_at),3)],10,ls))),128))])]),o.items.length>0?(i(),n("table",cs,[as,s("tbody",null,[(i(!0),n(h,null,m(o.items,(e,u)=>(i(),n("tr",{key:u,class:"text-center"},[s("th",rs,c(u+1),1),s("td",null,c(e.item.name),1),s("td",null,c(e.quantity),1)]))),128))])])):b("",!0)]))])])])}const ms=f(U,[["render",ds],["__scopeId","data-v-e344b15b"]]);export{ms as default};
